{% extends 'template.html' %}
{% block title %}Welcome to Stevens Book Marketplace{% endblock %}
{% block content %}
<!-- Search Section -->
<section id="stv-search">
    <div class="jumbotron text-center">
        <h1><strong>Stevens Book Marketplace</strong></h1>
        <form action="/" class="form-inline" method="POST">
            <div class="input-group ">
                <input type="search" name="jumbo-search" id="jumbo-search" class="form-control" size="50 " value="{{ search_input }}">
                <div class="input-group-btn ">
                    <button class="btn btn-default " type="submit" value="send">
                        <i class="glyphicon glyphicon-search "></i>
                    </button>
                </div>
            </div>
        </form>
    </div>
</section>

<!-- Listing Section -->
<section id="stv-listing">
<div class="container ">
    <div class="row">
        <nav class="col-sm-12" >
            <ul class="nav nav-pills" role="tablist">
              <li role="presentation"><a href="courses/">Course List</a></li>
                <!-- The reason why I like selling books badged here is because it's a motivator to sell,
                users has to login to see it, imo -PW -->
              <li role="presentation"><a href="#">Selling books <span class="badge">3</span></a></li>
            </ul>
        </nav>
    </div>

    <div class="row">
        <div class="col-sm-12">
            <div class="list-group container" id="course-container">
                
                {% if (book_results|count < 1) and (course_results|count < 1) %}
                <div class="list-group-item active">No results found for "{{ search_input }}"</div>
                {% endif %}

                {% if book_results|count > 0 %}
                <div class="list-group-item active">Book results for "{{ search_input }}"</div>
                {% for book in book_results %}
                    <a class="list-group-item" href="book/{{ book._id }}">
                        {{ book.get('google-metadata', {}).get('volumeInfo', {}).get("title") | default(book.get('stevens-metadata', {}).get('books-title'), True) }}
                        <span class="badge">{{ book._id }}</span>
                        <!-- Not sure if the below is correct, I had to target it as books.courses.0. in order to get anything -PW -->
                        <span class="badge">{{ book.courses.0.get('letter', "")+ "-" + book.courses.0.get('number', "NONE") }}</span>
                        <span class="badge">3</span>
                         <!-- this 3 above represents books's available, needs new value which queries the count available of the specific books listed -->
                    </a>
                {% endfor %}
                {% endif %}

                {% if course_results|count > 0 %}
                <div class="list-group-item active">Course results for "{{ search_input }}"</div>
                {% for course in course_results %}
                    <a class="list-group-item" href="courses/{{ course.get('letter') }}-{{ course.get('number') }}">
                        {{ course.get('letter') }}-{{ course.get('number') }}: {{ course.get('name') }}
                    </a>
                {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
</div>
</section>
{% endblock %}
